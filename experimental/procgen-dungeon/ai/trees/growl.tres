[gd_resource type="BehaviorTree" load_steps=114 format=3 uid="uid://qovuyc6ynb2h"]

[ext_resource type="Script" uid="uid://bn426ivu3ywl0" path="res://ai/tasks/targeting/set_target_to_nearest_entitytype_in_area.gd" id="1_m1u48"]
[ext_resource type="Script" uid="uid://jw2qpaclk80c" path="res://ai/tasks/play_sound.gd" id="2_m1u48"]
[ext_resource type="Script" uid="uid://cuxbc2kb6xqxd" path="res://ai/tasks/health/take_damage.gd" id="2_ngmj3"]
[ext_resource type="Script" uid="uid://b8ygx5burjyn8" path="res://ai/tasks/targeting/check_previous_target_entity.gd" id="2_tcm3l"]
[ext_resource type="AudioStream" uid="uid://b4vxkxjxrmnr2" path="res://assets/sounds/grunt/grunt_hurt.mp3" id="3_ngmj3"]
[ext_resource type="Script" uid="uid://vxa0kxnsbcss" path="res://ai/tasks/targeting/is_target_in_radius.gd" id="4_tcm3l"]
[ext_resource type="Script" uid="uid://d38ke8qdnl1eh" path="res://ai/tasks/hunger/eat_fruit.gd" id="5_s5x5c"]
[ext_resource type="AudioStream" uid="uid://b2alk1whurrwv" path="res://assets/sounds/grunt/grunt_bite.mp3" id="6_dieo1"]
[ext_resource type="Script" uid="uid://b137gs0yh5kii" path="res://ai/tasks/health/apply_damage_to_target.gd" id="6_tcm3l"]
[ext_resource type="Script" uid="uid://b5yoakfl32cml" path="res://ai/tasks/targeting/set_target_to_nearest_entitytype_in_sight.gd" id="7_ygmkd"]
[ext_resource type="AudioStream" uid="uid://di1sbylhimh3y" path="res://assets/sounds/grunt/grunt_hungry.mp3" id="8_3i16v"]
[ext_resource type="Script" uid="uid://cgicdjlkja61" path="res://ai/tasks/movement/pathfind_and_move.gd" id="10_m1u48"]
[ext_resource type="AudioStream" uid="uid://brqsnr3iryhfr" path="res://assets/sounds/grunt/grunt1.mp3" id="10_y40ie"]
[ext_resource type="Script" uid="uid://vy7v57abpwsp" path="res://ai/tasks/choose_random_pos.gd" id="11_ajmql"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_ihcj0"]
var/taken_damage_this_frame/name = &"taken_damage_this_frame"
var/taken_damage_this_frame/type = 1
var/taken_damage_this_frame/value = false
var/taken_damage_this_frame/hint = 0
var/taken_damage_this_frame/hint_string = ""

[sub_resource type="BBNode" id="BBNode_s5x5c"]
saved_value = NodePath("MoveAnimation")
resource_name = "MoveAnimation"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_qu6iv"]
animation_player = SubResource("BBNode_s5x5c")
animation_name = &"walk"

[sub_resource type="BTRunLimit" id="BTRunLimit_m5e10"]
children = [SubResource("BTPlayAnimation_qu6iv")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_m5e10"]
children = [SubResource("BTRunLimit_m5e10")]

[sub_resource type="BTSequence" id="BTSequence_lbuxp"]
custom_name = "Init setup"
children = [SubResource("BTAlwaysSucceed_m5e10")]

[sub_resource type="BBVariant" id="BBVariant_tcm3l"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_s5x5c"]
variable = &"taken_damage_this_frame"
value = SubResource("BBVariant_tcm3l")

[sub_resource type="BTAction" id="BTAction_dieo1"]
script = ExtResource("2_m1u48")
sound = ExtResource("3_ngmj3")

[sub_resource type="BBVariant" id="BBVariant_dieo1"]
type = 1
saved_value = false
resource_name = "<null>"

[sub_resource type="BTSetVar" id="BTSetVar_ygmkd"]
variable = &"taken_damage_this_frame"
value = SubResource("BBVariant_dieo1")

[sub_resource type="BTSequence" id="BTSequence_dieo1"]
children = [SubResource("BTCheckVar_s5x5c"), SubResource("BTAction_dieo1"), SubResource("BTSetVar_ygmkd")]

[sub_resource type="BBVariant" id="BBVariant_s5x5c"]
type = 3
saved_value = 750.0
resource_name = "750.0"

[sub_resource type="BTCheckVar" id="BTCheckVar_dieo1"]
variable = &"hunger"
check_type = 3
value = SubResource("BBVariant_s5x5c")

[sub_resource type="BTCooldown" id="BTCooldown_ygmkd"]
duration = 5.0
children = [SubResource("BTCheckVar_dieo1")]

[sub_resource type="BTAction" id="BTAction_ajmql"]
script = ExtResource("2_ngmj3")
damage = 1

[sub_resource type="BTAction" id="BTAction_odd6t"]
script = ExtResource("2_m1u48")
sound = ExtResource("3_ngmj3")

[sub_resource type="BTSequence" id="BTSequence_plrq1"]
custom_name = "Hunger pangs"
children = [SubResource("BTCooldown_ygmkd"), SubResource("BTAction_ajmql"), SubResource("BTAction_odd6t")]

[sub_resource type="BTSelector" id="BTSelector_ygmkd"]
custom_name = "Check for damage"
children = [SubResource("BTSequence_dieo1"), SubResource("BTSequence_plrq1")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_h7m1t"]
children = [SubResource("BTSelector_ygmkd")]

[sub_resource type="BTSequence" id="BTSequence_18vl1"]
custom_name = "Check if getting damaged"
children = [SubResource("BTAlwaysSucceed_h7m1t")]

[sub_resource type="BTAction" id="BTAction_ngmj3"]
script = ExtResource("1_m1u48")
area = &"aggression_area"

[sub_resource type="BTAction" id="BTAction_s5x5c"]
script = ExtResource("2_tcm3l")

[sub_resource type="BTWait" id="BTWait_5s0up"]
duration = 0.5

[sub_resource type="BBNode" id="BBNode_tcm3l"]
saved_value = NodePath("SizeAnimation")
resource_name = "SizeAnimation"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_s5x5c"]
animation_player = SubResource("BBNode_tcm3l")
animation_name = &"attack"

[sub_resource type="BTAction" id="BTAction_dmxdi"]
script = ExtResource("1_m1u48")
area = &"aggression_area"

[sub_resource type="BTAction" id="BTAction_2v265"]
script = ExtResource("2_tcm3l")

[sub_resource type="BTAction" id="BTAction_t7ibg"]
script = ExtResource("6_tcm3l")
damage = 1

[sub_resource type="BTWait" id="BTWait_tcm3l"]

[sub_resource type="BTSequence" id="BTSequence_m1u48"]
children = [SubResource("BTAction_ngmj3"), SubResource("BTAction_s5x5c"), SubResource("BTWait_5s0up"), SubResource("BTPlayAnimation_s5x5c"), SubResource("BTAction_dmxdi"), SubResource("BTAction_2v265"), SubResource("BTAction_t7ibg"), SubResource("BTWait_tcm3l")]

[sub_resource type="BTCooldown" id="BTCooldown_tcm3l"]
duration = 0.5
children = [SubResource("BTSequence_m1u48")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_m1u48"]
children = [SubResource("BTCooldown_tcm3l")]

[sub_resource type="BTSequence" id="BTSequence_s5x5c"]
custom_name = "Check if entity too close"
children = [SubResource("BTAlwaysSucceed_m1u48")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_tcm3l"]
children = [SubResource("BTSequence_s5x5c")]

[sub_resource type="BBNode" id="BBNode_m1u48"]
saved_value = NodePath("Tilter")
resource_name = "Tilter"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_jwj43"]
animation_player = SubResource("BBNode_m1u48")
animation_name = &"tilt"

[sub_resource type="BTProbability" id="BTProbability_kxk1o"]
children = [SubResource("BTPlayAnimation_jwj43")]

[sub_resource type="BBVariant" id="BBVariant_m5e10"]
type = 3
saved_value = 500.0
resource_name = "500.0"

[sub_resource type="BTCheckVar" id="BTCheckVar_ypr8g"]
variable = &"hunger"
check_type = 3
value = SubResource("BBVariant_m5e10")

[sub_resource type="BBVariant" id="BBVariant_0iyhc"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTSetVar" id="BTSetVar_81cv7"]
variable = &"is_hungry"
value = SubResource("BBVariant_0iyhc")

[sub_resource type="BTSequence" id="BTSequence_iqpph"]
custom_name = "Get hungry"
children = [SubResource("BTCheckVar_ypr8g"), SubResource("BTSetVar_81cv7")]

[sub_resource type="BBVariant" id="BBVariant_g3jbg"]
type = 3
saved_value = 100.0
resource_name = "100.0"

[sub_resource type="BTCheckVar" id="BTCheckVar_phada"]
variable = &"hunger"
check_type = 2
value = SubResource("BBVariant_g3jbg")

[sub_resource type="BBVariant" id="BBVariant_ydfj1"]
type = 1
saved_value = false
resource_name = "<null>"

[sub_resource type="BTSetVar" id="BTSetVar_3806r"]
variable = &"is_hungry"
value = SubResource("BBVariant_ydfj1")

[sub_resource type="BBNode" id="BBNode_0iyhc"]
saved_value = NodePath("MoveAnimation")
resource_name = "MoveAnimation"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_81cv7"]
animation_player = SubResource("BBNode_0iyhc")
animation_name = &"walk"

[sub_resource type="BTSequence" id="BTSequence_en5op"]
custom_name = "Stop hungry"
children = [SubResource("BTCheckVar_phada"), SubResource("BTSetVar_3806r"), SubResource("BTPlayAnimation_81cv7")]

[sub_resource type="BTSelector" id="BTSelector_hyiyp"]
custom_name = "Decide if hungry or not"
children = [SubResource("BTSequence_iqpph"), SubResource("BTSequence_en5op")]

[sub_resource type="BTCooldown" id="BTCooldown_6u2m4"]
duration = 1.0
children = [SubResource("BTSelector_hyiyp")]

[sub_resource type="BTCondition" id="BTCondition_alme7"]
script = ExtResource("4_tcm3l")
radius = 50.0

[sub_resource type="BTWait" id="BTWait_kxk1o"]
duration = 2.5

[sub_resource type="BTAction" id="BTAction_ucdji"]
script = ExtResource("5_s5x5c")

[sub_resource type="BTAction" id="BTAction_kosrh"]
script = ExtResource("2_m1u48")
sound = ExtResource("6_dieo1")

[sub_resource type="BTSequence" id="BTSequence_kxk1o"]
custom_name = "If nearby fruit, stop and eat the fruit"
children = [SubResource("BTCondition_alme7"), SubResource("BTWait_kxk1o"), SubResource("BTAction_ucdji"), SubResource("BTAction_kosrh")]

[sub_resource type="BBVariant" id="BBVariant_agbi4"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_bxkr4"]
variable = &"is_hungry"
value = SubResource("BBVariant_agbi4")

[sub_resource type="BTAction" id="BTAction_alme7"]
script = ExtResource("7_ygmkd")
target_class = "Fruit"

[sub_resource type="BTAction" id="BTAction_g73xh"]
script = ExtResource("2_m1u48")
sound = ExtResource("8_3i16v")

[sub_resource type="BTProbability" id="BTProbability_ypr8g"]
run_chance = 0.25
children = [SubResource("BTAction_g73xh")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_0iyhc"]
children = [SubResource("BTProbability_ypr8g")]

[sub_resource type="BTAction" id="BTAction_qu6iv"]
script = ExtResource("10_m1u48")
tolerance = 0.5

[sub_resource type="BTTimeLimit" id="BTTimeLimit_lbuxp"]
time_limit = 2.5
children = [SubResource("BTAction_qu6iv")]

[sub_resource type="BTSequence" id="BTSequence_ypr8g"]
custom_name = "Pathfind & move"
children = [SubResource("BTTimeLimit_lbuxp")]

[sub_resource type="BTSequence" id="BTSequence_alme7"]
custom_name = "If hungry, move towards fruit"
children = [SubResource("BTCheckVar_bxkr4"), SubResource("BTAction_alme7"), SubResource("BTAlwaysSucceed_0iyhc"), SubResource("BTSequence_ypr8g")]

[sub_resource type="BTCooldown" id="BTCooldown_ppwhi"]
duration = 1.5
children = [SubResource("BTSequence_alme7")]

[sub_resource type="BTSelector" id="BTSelector_alme7"]
custom_name = "Seek food"
children = [SubResource("BTCooldown_6u2m4"), SubResource("BTSequence_kxk1o"), SubResource("BTCooldown_ppwhi")]

[sub_resource type="BBNode" id="BBNode_0ntti"]
saved_value = NodePath("MoveAnimation")
resource_name = "MoveAnimation"

[sub_resource type="BTPauseAnimation" id="BTPauseAnimation_m1u48"]
animation_player = SubResource("BBNode_0ntti")

[sub_resource type="BTRandomWait" id="BTRandomWait_ngmj3"]

[sub_resource type="BTSequence" id="BTSequence_tcm3l"]
children = [SubResource("BTPauseAnimation_m1u48"), SubResource("BTRandomWait_ngmj3")]

[sub_resource type="BTProbability" id="BTProbability_s5x5c"]
run_chance = 0.05
children = [SubResource("BTSequence_tcm3l")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_dieo1"]
children = [SubResource("BTProbability_s5x5c")]

[sub_resource type="BTCooldown" id="BTCooldown_0ntti"]
duration = 1.0
children = [SubResource("BTAlwaysSucceed_dieo1")]

[sub_resource type="BTSequence" id="BTSequence_ygmkd"]
custom_name = "Pause"
children = [SubResource("BTCooldown_0ntti")]

[sub_resource type="BBNode" id="BBNode_3i16v"]
saved_value = NodePath("MoveAnimation")
resource_name = "MoveAnimation"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_v3auq"]
animation_player = SubResource("BBNode_3i16v")

[sub_resource type="BTAction" id="BTAction_iqpph"]
script = ExtResource("2_m1u48")
sound = ExtResource("10_y40ie")

[sub_resource type="BTProbability" id="BTProbability_g3jbg"]
run_chance = 0.02
children = [SubResource("BTAction_iqpph")]

[sub_resource type="BTCooldown" id="BTCooldown_phada"]
duration = 3.0
children = [SubResource("BTProbability_g3jbg")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_ydfj1"]
children = [SubResource("BTCooldown_phada")]

[sub_resource type="BTSequence" id="BTSequence_3806r"]
custom_name = "Make a sound"
children = [SubResource("BTAlwaysSucceed_ydfj1")]

[sub_resource type="BTAction" id="BTAction_kxk1o"]
script = ExtResource("11_ajmql")
range_min = 25.0
range_max = 50.0

[sub_resource type="BTProbability" id="BTProbability_alme7"]
run_chance = 0.1
children = [SubResource("BTAction_kxk1o")]

[sub_resource type="BTSequence" id="BTSequence_thmw6"]
custom_name = "target long"
children = [SubResource("BTProbability_alme7")]

[sub_resource type="BTAction" id="BTAction_l4anq"]
script = ExtResource("11_ajmql")

[sub_resource type="BTSequence" id="BTSequence_kosrh"]
custom_name = "target short"
children = [SubResource("BTAction_l4anq")]

[sub_resource type="BTSelector" id="BTSelector_l4anq"]
custom_name = "Pick a long or short distance to move randomly"
children = [SubResource("BTSequence_thmw6"), SubResource("BTSequence_kosrh")]

[sub_resource type="BTAction" id="BTAction_jwj43"]
script = ExtResource("10_m1u48")
tolerance = 0.5

[sub_resource type="BTTimeLimit" id="BTTimeLimit_l4anq"]
time_limit = 2.5
children = [SubResource("BTAction_jwj43")]

[sub_resource type="BTSequence" id="BTSequence_0iyhc"]
custom_name = "Pathfind and move"
children = [SubResource("BTTimeLimit_l4anq")]

[sub_resource type="BTSequence" id="BTSequence_jwj43"]
custom_name = "Wander"
children = [SubResource("BTPlayAnimation_v3auq"), SubResource("BTSequence_3806r"), SubResource("BTSelector_l4anq"), SubResource("BTSequence_0iyhc")]

[sub_resource type="BTSelector" id="BTSelector_kxk1o"]
custom_name = "Wander or seek food"
children = [SubResource("BTSelector_alme7"), SubResource("BTSequence_ygmkd"), SubResource("BTSequence_jwj43")]

[sub_resource type="BTSequence" id="BTSequence_6kuyo"]
custom_name = "Wander Around Aimlessly"
children = [SubResource("BTProbability_kxk1o"), SubResource("BTSelector_kxk1o")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_s5x5c"]
children = [SubResource("BTSequence_6kuyo")]

[sub_resource type="BTSequence" id="BTSequence_ucdji"]
custom_name = "Main behavior sequence"
children = [SubResource("BTAlwaysSucceed_tcm3l"), SubResource("BTAlwaysSucceed_s5x5c")]

[sub_resource type="BTSequence" id="BTSequence_ppwhi"]
children = [SubResource("BTSequence_lbuxp"), SubResource("BTSequence_18vl1"), SubResource("BTSequence_ucdji")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_ihcj0")
root_task = SubResource("BTSequence_ppwhi")
