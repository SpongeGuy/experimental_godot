[gd_resource type="BehaviorTree" load_steps=86 format=3 uid="uid://7sa2dhcn0k84"]

[ext_resource type="Script" uid="uid://cuxbc2kb6xqxd" path="res://ai/tasks/health/take_damage.gd" id="1_jwrcf"]
[ext_resource type="Script" uid="uid://jw2qpaclk80c" path="res://ai/tasks/play_sound.gd" id="2_c5ent"]
[ext_resource type="AudioStream" uid="uid://b4vxkxjxrmnr2" path="res://assets/sounds/grunt/grunt_hurt.mp3" id="3_tlc2v"]
[ext_resource type="Script" uid="uid://vxa0kxnsbcss" path="res://ai/tasks/targeting/is_target_in_radius.gd" id="4_t3fvu"]
[ext_resource type="Script" uid="uid://d38ke8qdnl1eh" path="res://ai/tasks/hunger/eat_fruit.gd" id="5_3s7d5"]
[ext_resource type="AudioStream" uid="uid://b2alk1whurrwv" path="res://assets/sounds/grunt/grunt_bite.mp3" id="6_27p1r"]
[ext_resource type="Script" uid="uid://dij57qyw0s13g" path="res://ai/tasks/movement/set_pathfind_target_to_blackboard_target_entity.gd" id="8_c5ent"]
[ext_resource type="AudioStream" uid="uid://di1sbylhimh3y" path="res://assets/sounds/grunt/grunt_hungry.mp3" id="8_qnfrp"]
[ext_resource type="Script" uid="uid://cgicdjlkja61" path="res://ai/tasks/movement/pathfind_and_move.gd" id="9_jwrcf"]
[ext_resource type="AudioStream" uid="uid://brqsnr3iryhfr" path="res://assets/sounds/grunt/grunt1.mp3" id="10_d84gv"]
[ext_resource type="Script" uid="uid://vy7v57abpwsp" path="res://ai/tasks/choose_random_pos.gd" id="11_b4hvv"]
[ext_resource type="Script" uid="uid://bn426ivu3ywl0" path="res://ai/tasks/targeting/set_target_to_nearest_entitytype_in_area.gd" id="11_tlc2v"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_ihcj0"]

[sub_resource type="BBNode" id="BBNode_alme7"]
saved_value = NodePath("Animations/MoveAnimation")
resource_name = "Animations/MoveAnimation"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_qu6iv"]
animation_player = SubResource("BBNode_alme7")
animation_name = &"walk"

[sub_resource type="BTRunLimit" id="BTRunLimit_m5e10"]
children = [SubResource("BTPlayAnimation_qu6iv")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_m5e10"]
children = [SubResource("BTRunLimit_m5e10")]

[sub_resource type="BTSequence" id="BTSequence_lbuxp"]
custom_name = "Init setup"
children = [SubResource("BTAlwaysSucceed_m5e10")]

[sub_resource type="BBVariant" id="BBVariant_c5ent"]
type = 3
saved_value = 750.0
resource_name = "750.0"

[sub_resource type="BTCheckVar" id="BTCheckVar_tlc2v"]
variable = &"hunger"
check_type = 3
value = SubResource("BBVariant_c5ent")

[sub_resource type="BTCooldown" id="BTCooldown_t3fvu"]
duration = 5.0
children = [SubResource("BTCheckVar_tlc2v")]

[sub_resource type="BBNode" id="BBNode_3s7d5"]
saved_value = NodePath("HurtAnimation")
resource_name = "HurtAnimation"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_27p1r"]
animation_player = SubResource("BBNode_3s7d5")
animation_name = &"hurt"

[sub_resource type="BTAction" id="BTAction_p5dae"]
script = ExtResource("1_jwrcf")
damage = 1

[sub_resource type="BTAction" id="BTAction_qnfrp"]
script = ExtResource("2_c5ent")
sound = ExtResource("3_tlc2v")

[sub_resource type="BTSequence" id="BTSequence_hysg8"]
custom_name = "Hunger pangs"
children = [SubResource("BTCooldown_t3fvu"), SubResource("BTPlayAnimation_27p1r"), SubResource("BTAction_p5dae"), SubResource("BTAction_qnfrp")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_d84gv"]
children = [SubResource("BTSequence_hysg8")]

[sub_resource type="BTSequence" id="BTSequence_b4hvv"]
custom_name = "Check if starving"
children = [SubResource("BTAlwaysSucceed_d84gv")]

[sub_resource type="BBNode" id="BBNode_l4anq"]
saved_value = NodePath("Animations/Tilter")
resource_name = "Animations/Tilter"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_jwj43"]
animation_player = SubResource("BBNode_l4anq")
animation_name = &"tilt"

[sub_resource type="BTProbability" id="BTProbability_kxk1o"]
children = [SubResource("BTPlayAnimation_jwj43")]

[sub_resource type="BBVariant" id="BBVariant_m5e10"]
type = 3
saved_value = 500.0
resource_name = "500.0"

[sub_resource type="BTCheckVar" id="BTCheckVar_ypr8g"]
variable = &"hunger"
check_type = 3
value = SubResource("BBVariant_m5e10")

[sub_resource type="BBVariant" id="BBVariant_0iyhc"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTSetVar" id="BTSetVar_81cv7"]
variable = &"is_hungry"
value = SubResource("BBVariant_0iyhc")

[sub_resource type="BBNode" id="BBNode_m5e10"]
saved_value = NodePath("Animations/MoveAnimation")
resource_name = "Animations/MoveAnimation"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_ypr8g"]
animation_player = SubResource("BBNode_m5e10")
animation_name = &"hungry_walk"

[sub_resource type="BTSequence" id="BTSequence_iqpph"]
custom_name = "Get hungry"
children = [SubResource("BTCheckVar_ypr8g"), SubResource("BTSetVar_81cv7"), SubResource("BTPlayAnimation_ypr8g")]

[sub_resource type="BBVariant" id="BBVariant_g3jbg"]
type = 3
saved_value = 100.0
resource_name = "100.0"

[sub_resource type="BTCheckVar" id="BTCheckVar_phada"]
variable = &"hunger"
check_type = 2
value = SubResource("BBVariant_g3jbg")

[sub_resource type="BBVariant" id="BBVariant_ydfj1"]
type = 1
saved_value = false
resource_name = "<null>"

[sub_resource type="BTSetVar" id="BTSetVar_3806r"]
variable = &"is_hungry"
value = SubResource("BBVariant_ydfj1")

[sub_resource type="BBNode" id="BBNode_0iyhc"]
saved_value = NodePath("Animations/MoveAnimation")
resource_name = "Animations/MoveAnimation"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_81cv7"]
animation_player = SubResource("BBNode_0iyhc")
animation_name = &"walk"

[sub_resource type="BTSequence" id="BTSequence_en5op"]
custom_name = "Stop hungry"
children = [SubResource("BTCheckVar_phada"), SubResource("BTSetVar_3806r"), SubResource("BTPlayAnimation_81cv7")]

[sub_resource type="BTSelector" id="BTSelector_hyiyp"]
custom_name = "Decide if hungry or not"
children = [SubResource("BTSequence_iqpph"), SubResource("BTSequence_en5op")]

[sub_resource type="BTCooldown" id="BTCooldown_6u2m4"]
duration = 1.0
children = [SubResource("BTSelector_hyiyp")]

[sub_resource type="BTCondition" id="BTCondition_alme7"]
script = ExtResource("4_t3fvu")
radius = 50.0

[sub_resource type="BTWait" id="BTWait_kxk1o"]
duration = 2.5

[sub_resource type="BTAction" id="BTAction_ucdji"]
script = ExtResource("5_3s7d5")

[sub_resource type="BTAction" id="BTAction_kosrh"]
script = ExtResource("2_c5ent")
sound = ExtResource("6_27p1r")

[sub_resource type="BTSequence" id="BTSequence_kxk1o"]
custom_name = "If nearby fruit, stop and eat the fruit"
children = [SubResource("BTCondition_alme7"), SubResource("BTWait_kxk1o"), SubResource("BTAction_ucdji"), SubResource("BTAction_kosrh")]

[sub_resource type="BBVariant" id="BBVariant_agbi4"]
type = 1
saved_value = true
resource_name = "true"

[sub_resource type="BTCheckVar" id="BTCheckVar_bxkr4"]
variable = &"is_hungry"
value = SubResource("BBVariant_agbi4")

[sub_resource type="BTAction" id="BTAction_t3fvu"]
script = ExtResource("11_tlc2v")
target_entity_class = Array[String](["Fruit"])
area = &"detection"

[sub_resource type="BTAction" id="BTAction_tlc2v"]
script = ExtResource("8_c5ent")

[sub_resource type="BTAction" id="BTAction_g73xh"]
script = ExtResource("2_c5ent")
sound = ExtResource("8_qnfrp")

[sub_resource type="BTProbability" id="BTProbability_ypr8g"]
run_chance = 0.25
children = [SubResource("BTAction_g73xh")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_0iyhc"]
children = [SubResource("BTProbability_ypr8g")]

[sub_resource type="BTAction" id="BTAction_qu6iv"]
script = ExtResource("9_jwrcf")
tolerance = 1.5

[sub_resource type="BTTimeLimit" id="BTTimeLimit_lbuxp"]
time_limit = 2.5
children = [SubResource("BTAction_qu6iv")]

[sub_resource type="BTSequence" id="BTSequence_ypr8g"]
custom_name = "Pathfind & move"
children = [SubResource("BTTimeLimit_lbuxp")]

[sub_resource type="BTSequence" id="BTSequence_alme7"]
custom_name = "If hungry, move towards fruit"
children = [SubResource("BTCheckVar_bxkr4"), SubResource("BTAction_t3fvu"), SubResource("BTAction_tlc2v"), SubResource("BTAlwaysSucceed_0iyhc"), SubResource("BTSequence_ypr8g")]

[sub_resource type="BTCooldown" id="BTCooldown_ppwhi"]
duration = 1.5
children = [SubResource("BTSequence_alme7")]

[sub_resource type="BTSelector" id="BTSelector_alme7"]
custom_name = "Seek food"
children = [SubResource("BTCooldown_6u2m4"), SubResource("BTSequence_kxk1o"), SubResource("BTCooldown_ppwhi")]

[sub_resource type="BTAction" id="BTAction_iqpph"]
script = ExtResource("2_c5ent")
sound = ExtResource("10_d84gv")

[sub_resource type="BTProbability" id="BTProbability_g3jbg"]
run_chance = 0.02
children = [SubResource("BTAction_iqpph")]

[sub_resource type="BTCooldown" id="BTCooldown_phada"]
duration = 3.0
children = [SubResource("BTProbability_g3jbg")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_ydfj1"]
children = [SubResource("BTCooldown_phada")]

[sub_resource type="BTSequence" id="BTSequence_3806r"]
custom_name = "Make a sound"
children = [SubResource("BTAlwaysSucceed_ydfj1")]

[sub_resource type="BTAction" id="BTAction_kxk1o"]
script = ExtResource("11_b4hvv")
range_min = 25.0
range_max = 50.0

[sub_resource type="BTProbability" id="BTProbability_alme7"]
run_chance = 0.1
children = [SubResource("BTAction_kxk1o")]

[sub_resource type="BTSequence" id="BTSequence_thmw6"]
custom_name = "target long"
children = [SubResource("BTProbability_alme7")]

[sub_resource type="BTAction" id="BTAction_l4anq"]
script = ExtResource("11_b4hvv")

[sub_resource type="BTSequence" id="BTSequence_kosrh"]
custom_name = "target short"
children = [SubResource("BTAction_l4anq")]

[sub_resource type="BTSelector" id="BTSelector_l4anq"]
custom_name = "Pick a long or short distance to move randomly"
children = [SubResource("BTSequence_thmw6"), SubResource("BTSequence_kosrh")]

[sub_resource type="BTAction" id="BTAction_jwj43"]
script = ExtResource("9_jwrcf")
tolerance = 2.0

[sub_resource type="BTTimeLimit" id="BTTimeLimit_l4anq"]
time_limit = 2.5
children = [SubResource("BTAction_jwj43")]

[sub_resource type="BTSequence" id="BTSequence_0iyhc"]
custom_name = "Pathfind and move"
children = [SubResource("BTTimeLimit_l4anq")]

[sub_resource type="BTSequence" id="BTSequence_jwj43"]
custom_name = "Wander"
children = [SubResource("BTSequence_3806r"), SubResource("BTSelector_l4anq"), SubResource("BTSequence_0iyhc")]

[sub_resource type="BTSelector" id="BTSelector_kxk1o"]
custom_name = "Wander or seek food"
children = [SubResource("BTSelector_alme7"), SubResource("BTSequence_jwj43")]

[sub_resource type="BTSequence" id="BTSequence_6kuyo"]
custom_name = "Wander Around Aimlessly"
children = [SubResource("BTProbability_kxk1o"), SubResource("BTSelector_kxk1o")]

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_c5ent"]
children = [SubResource("BTSequence_6kuyo")]

[sub_resource type="BTSequence" id="BTSequence_ucdji"]
custom_name = "Main behavior sequence"
children = [SubResource("BTSequence_b4hvv"), SubResource("BTAlwaysSucceed_c5ent")]

[sub_resource type="BTSequence" id="BTSequence_ppwhi"]
children = [SubResource("BTSequence_lbuxp"), SubResource("BTSequence_ucdji")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_ihcj0")
root_task = SubResource("BTSequence_ppwhi")
